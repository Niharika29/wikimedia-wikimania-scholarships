{% extends "review/base.html" %}
{% set route = app.router.getCurrentRoute.getName %}

{% block content %}
{% spaceless %}
<ol class="breadcrumb">
  <li>{{ wgLang.message( 'nav-review' ) }}</li>
  <li>{{ wgLang.message( 'search' ) }}</li>
</ol>

<form class="form-inline" method="get" action="{{ urlFor( route ) }}" role="form">

  <input type="hidden" name="p" value="0">
  <div class="form-group">
    <label class="sr-only" for="lastname">{{ wgLang.message( 'form-lname' ) }}</label>
    <input type="text" name="l" id="lastname" placeholder="{{ wgLang.message( 'form-lname' ) }}" value="{{ l }}">
  </div>

  <div class="form-group">
    <label class="sr-only" for="firstname">{{ wgLang.message( 'form-fname' ) }}</label>
    <input type="text" name="f" id="firstname" placeholder="{{ wgLang.message( 'form-fname' ) }}" value="{{ f }}">
  </div>

  <div class="form-group">
    <label class="sr-only" for="residence">{{ wgLang.message( 'form-residence' ) }}</label>
    <input type="text" name="r" id="residence" placeholder="{{ wgLang.message( 'form-residence' ) }}" value="{{ r }}">
  </div>

  <div class="form-group">
    <label class="sr-only" for="region">{{ wgLang.message( 'search-region' ) }}</label>
    <input type="text" name="rg" id="region" placeholder="{{ wgLang.message( 'search-region' ) }}" value="{{ rg }}">
  </div>

  <div class="form-group">
    <label class="sr-only" for="community-size">{{ wgLang.message( 'search-sommunity-size' ) }}</label>
    <input type="text" name="cs" id="community" placeholder="{{ wgLang.message( 'search-community-size' ) }}" value="{{ cs }}">
  </div>

  <div class="form-group">
    <label class="sr-only" for="globalns">{{ wgLang.message( 'search-globalns' ) }}</label>
    <input type="text" name="ns" id="globalns" placeholder="{{ wgLang.message( 'search-globalns' ) }}" value="{{ ns }}">
  </div>

  <div class="form-group">
    <label class="control-label">
      <input type="checkbox" id="p1" name="p1" value="1" {{ p1 == 1 ? 'checked="checked"' }}/>&nbsp;
      {{ wgLang.message( 'search-phase1' ) }}
    </label>
  </div>

  <div class="form-group">
    <input type="submit" class="btn btn-sm btn-primary" value="{{ wgLang.message( 'search' ) }}" />
  </div>

</form>

<p></p>

{% if found is not null %}
<table class="table table-striped table-hover table-condensed table-responsive">
  <tr>
    <th>{{ wgLang.message( 'review-list-id' ) }}</th>
    <th>{{ wgLang.message( 'review-list-name' ) }}</th>
    <th>{{ wgLang.message( 'review-list-email' ) }}</th>
    <th>{{ wgLang.message( 'review-list-residence' ) }}</th>
    <th>{{ wgLang.message( 'review-list-gender' ) }}</th>
    <th>{{ wgLang.message( 'review-list-age' ) }}</th>
    <th>{{ wgLang.message( 'review-list-p1-score' ) }}</th>
  </tr>
  {% for row in records %}
  <tr>
    <td>{{ row.id }}</td>
    <td><a href="{{ urlFor( 'review_view' ) }}?id={{ row.id }}&phase=2">{{ row.fname }} {{ row.lname }}</a></td>
    <td>{{ row.email }}</td>
    <td>{{ row.country_name }}</td>
    <td>{{ row.gender }}</td>
    <td>{{ row.age }}</td>
    <td>{{ row.p1count ? row.p1score : '-' }}</td>
  </tr>
  {% else %}
  <tr><td colspan="8">{{ wgLang.message( 'no-results' ) }}</td></tr>
  {% endfor %}
</table>

<div class="row">
  <div class="col-md-3">
    <p class="text-right">{{ wgLang.message( 'page-of-pages', [ p + 1, pages ] ) }}</p>
  </div>
  <div class="col-md-9">
      <ul class="pagination">
        {% if p > 0 %}
        <li><a href="{{ urlFor( route ) }}?{{ qsMerge( { 'p':(p - 1) } ) }}" id="prev">&laquo;</a></li>
        {% else %}
        <li class="disabled"><span>&laquo;</span></li>
        {% endif %}
        {% if left > 0 %}<li class="disabled"><span>&hellip;</span></li>{% endif %}
        {% for i in left .. right %}
        <li class="{{ i == p ? 'active' }}"><a href="{{ urlFor( route ) }}?{{ qsMerge( { 'p':i } ) }}" id="prev">{{ i + 1 }}</a></li>
        {% endfor %}
        {% if right < pages - 1 %}<li class="disabled"><span>&hellip;</span></li>{% endif %}
        {% if p + 1 < pages %}
        <li><a href="{{ urlFor( route ) }}?{{ qsMerge( { 'p':(p + 1) } ) }}" >&raquo;</a></li>
        {% else %}
        <li class="disabled"><span>&raquo;</span></li>
        {% endif %}
      </ul>
  </div>
</div>
{% endif %}
{% endspaceless %}
{% endblock content %}
